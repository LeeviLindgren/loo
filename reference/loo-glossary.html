<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>LOO package glossary — loo-glossary • loo</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="LOO package glossary — loo-glossary" />

<meta property="og:description" content="Note: VGG2017a refers to Vehtari, Gelman, and Gabry (2017a). See
  References, below." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">loo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/loo">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>LOO package glossary</h1>
    
    <div class="hidden name"><code>loo-glossary.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Note: VGG2017a refers to Vehtari, Gelman, and Gabry (2017a). See
  <strong>References</strong>, below.</p>
    
    </div>

        
    <h2 class="hasAnchor" id="elpd-and-elpd-loo"><a class="anchor" href="#elpd-and-elpd-loo"></a>ELPD and <code>elpd_loo</code></h2>

    
    <p>The ELPD is the theoretical expected log pointwise predictive density for a new
dataset (Eq 1 in VGG2017a), which can be estimated, e.g., using
cross-validation. <code>elpd_loo</code> is the Bayesian LOO estimate of the
expected log pointwise predictive density (Eq 4 in VGG2017a) and
is a sum of N individual pointwise log predictive densities. Probability
densities can be smaller or larger than 1, and thus log predictive densities
can be negative or positive. For simplicity the ELPD acronym is used also for
expected log pointwise predictive probabilities for discrete models.
Probabilities are always equal or less than 1, and thus log predictive
probabilities are 0 or negative.</p>
    
    <h2 class="hasAnchor" id="standard-error-of-elpd-loo"><a class="anchor" href="#standard-error-of-elpd-loo"></a>Standard error of <code>elpd_loo</code></h2>

    
    <p>As <code>elpd_loo</code> is defined as the sum of N independent components (Eq 4 in
VGG2017a), we can compute the standard error by using the standard deviation
of the N components and multiplying by <code><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>sqrt(N)</a></code> (Eq 23 in VGG2017a).
This standard error is a coarse description of our uncertainty about the
predictive performance for unknown future data. When N is small or there is
severe model misspecification, the current SE estimate is overoptimistic and
the actual SE can even be twice as large. Even for moderate N, when the SE
estimate is an accurate estimate for the scale, it ignores the skewness. When
making model comparisons, the SE of the component-wise (pairwise) differences
should be used instead (see the <code>se_diff</code> section below and Eq 24 in
VGG2017a).</p>
    
    <h2 class="hasAnchor" id="monte-carlo-se-of-elpd-loo"><a class="anchor" href="#monte-carlo-se-of-elpd-loo"></a>Monte Carlo SE of elpd_loo</h2>

    
    <p>The Monte Carlo standard error is the estimate for the computational accuracy
of MCMC and importance sampling used to compute <code>elpd_loo</code>. Usually this
is negligible compared to the standard describing the uncertainty due to
finite number of observations (Eq 23 in VGG2017a).</p>
    
    <h2 class="hasAnchor" id="p-loo-effective-number-of-parameters-"><a class="anchor" href="#p-loo-effective-number-of-parameters-"></a><code>p_loo</code> (effective number of parameters)</h2>

    
    <p><code>p_loo</code> is the difference between <code>elpd_loo</code> and the non-cross-validated
log posterior predictive density. It describes how much more difficult it
is to predict future data than the observed data. Asymptotically under
certain regularity conditions, <code>p_loo</code> can be interpreted as the
<em>effective number of parameters</em>. In well behaving cases <code>p_loo &lt; N</code> and
<code>p_loo &lt; p</code>, where <code>p</code> is the total number of parameters in the
model. <code>p_loo &gt; N</code>  or <code>p_loo &gt; p</code> indicates that the model has very
weak predictive capability and may indicate a severe model misspecification.
See below for more on interpreting <code>p_loo</code> when there are warnings
about high Pareto k diagnostic values.</p>
    
    <h2 class="hasAnchor" id="pareto-k-estimates"><a class="anchor" href="#pareto-k-estimates"></a>Pareto k estimates</h2>

    
    <p>The Pareto <code>k</code> estimate is a diagnostic for Pareto smoothed importance
sampling (PSIS), which is used to compute components of <code>elpd_loo</code>. In
importance-sampling LOO (the full posterior distribution is used as the
proposal distribution). The Pareto k diagnostic estimates how far an
individual leave-one-out distribution is from the full distribution. If
leaving out an observation changes the posterior too much then importance
sampling is not able to give reliable estimate. If <code>k&lt;0.5</code>, then the
corresponding component of <code>elpd_loo</code> is estimated with high accuracy.
If <code>0.5&lt;k&lt;0.7</code> the accuracy is lower, but still ok. If <code>k&gt;0.7</code>,
then importance sampling is not able to provide useful estimate for that
component/observation. Pareto k is also useful as a measure of influence of
an observation. Highly influential observations have high k values. Very high
k values often indicate model misspecification, outliers or mistakes in data
processing. See Section 6 of Gabry et al. (2019) for an example.</p>
<h3>Interpreting <code>p_loo</code> when Pareto <code>k</code> is large</h3>
    If <code>k &gt; 0.7</code> then we can also look at the <code>p_loo</code> estimate for
some additional information about the problem:
    <ul>
<li><p>If <code>p_loo &lt;&lt; p</code> (the total number of parameters in the model),
then the model is likely to be misspecified. Posterior predictive checks
(PPCs) are then likely to also detect the problem. Try using an overdispersed
model, or add more structural information (nonlinearity, mixture model,
etc.).</p></li>
<li><p>If <code>p_loo &lt; p</code> and the number of parameters <code>p</code> is relatively
large compared to the number of observations (e.g., <code>p&gt;N/5</code>), it is
likely that the model is so flexible or the population prior so weak that it’s
difficult to predict the left out observation (even for the true model).
This happens, for example, in the simulated 8 schools (in VGG2017a), random
effect models with a few observations per random effect, and Gaussian
processes and spatial models with short correlation lengths.</p></li>
<li><p>If <code>p_loo &gt; p</code>, then the model is likely to be badly misspecified.
If the number of parameters <code>p&lt;&lt;N</code>, then PPCs are also likely to detect the
problem. See the case study at
<a href='https://avehtari.github.io/modelselection/roaches.html'>https://avehtari.github.io/modelselection/roaches.html</a> for an example.
If <code>p</code> is relatively large compared to the number of
observations, say <code>p&gt;N/5</code> (more accurately we should count number of
observations influencing each parameter as in hierarchical models some groups
may have few observations and other groups many), it is possible that PPCs won't
detect the problem.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="elpd-diff"><a class="anchor" href="#elpd-diff"></a>elpd_diff</h2>

    
    <p><code>elpd_diff</code> is the difference in <code>elpd_loo</code> for two models. If more
than two models are compared, the difference is computed relative to the
model with highest <code>elpd_loo</code>.</p>
    
    <h2 class="hasAnchor" id="se-diff"><a class="anchor" href="#se-diff"></a>se_diff</h2>

    
    <p>The standard error of component-wise differences of elpd_loo (Eq 24 in
VGG2017a) between two models. This SE is <em>smaller</em> than the SE for
individual models due to correlation (i.e., if some observations are easier
and some more difficult to predict for all models).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Vehtari, A., Gelman, A., and Gabry, J. (2017a). Practical
  Bayesian model evaluation using leave-one-out cross-validation and WAIC.
  <em>Statistics and Computing</em>. 27(5), 1413--1432.
  doi:10.1007/s11222-016-9696-4.
  (<a href='http://link.springer.com/article/10.1007%2Fs11222-016-9696-4'>
  journal</a>, <a href='http://arxiv.org/abs/1507.04544'>preprint arXiv:1507.04544</a>).</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017b). Pareto smoothed
importance sampling. arXiv preprint: <a href='http://arxiv.org/abs/1507.02646/'>http://arxiv.org/abs/1507.02646/</a></p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and
  Gelman, A. (2019), Visualization in Bayesian workflow. <em>J. R. Stat.
  Soc. A</em>, 182: 389-402. doi:10.1111/rssa.12378,
  (<a href='https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378'>journal</a>,
  <a href='https://arxiv.org/abs/1709.01449'>arXiv preprint</a>)</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#elpd-and-elpd-loo">ELPD and <code>elpd_loo</code></a></li>

      <li><a href="#standard-error-of-elpd-loo">Standard error of <code>elpd_loo</code></a></li>

      <li><a href="#monte-carlo-se-of-elpd-loo">Monte Carlo SE of elpd_loo</a></li>

      <li><a href="#p-loo-effective-number-of-parameters-"><code>p_loo</code> (effective number of parameters)</a></li>

      <li><a href="#pareto-k-estimates">Pareto k estimates</a></li>

      <li><a href="#elpd-diff">elpd_diff</a></li>

      <li><a href="#se-diff">se_diff</a></li>

      <li><a href="#references">References</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Aki Vehtari, Andrew Gelman, Jonah Gabry, Yuling Yao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

