<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Diagnostics for Pareto Smoothed Importance Sampling — pareto-k-diagnostic • loo</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">loo</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/loo">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Diagnostics for Pareto Smoothed Importance Sampling</h1>
    </div>

    
    <p>Print a diagnostic table summarizing the estimated Pareto shape parameters,
find the indexes of observations for which the estimated Pareto shape
parameter \(k\) is larger than some <code>threshold</code> value, or plot
observation indexes vs \(k\) estimates.</p>
    

    <pre class="usage"><span class='fu'>pareto_k_table</span>(<span class='no'>x</span>)

<span class='fu'>pareto_k_ids</span>(<span class='no'>x</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

<span class='co'># S3 method for loo</span>
<span class='fu'>plot</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='kw'>label_points</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>For <code>pareto_k_ids</code> and <code>pareto_k_table</code>, an object created
by <code><a href='loo.html'>loo</a></code> or <code><a href='psislw.html'>psislw</a></code>. For <code>plot</code>, an object
created by <code><a href='loo.html'>loo</a></code>.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>The threshold value for \(k\).</p></td>
    </tr>
    <tr>
      <th>label_points, ...</th>
      <td><p>For the <code>plot</code> method, if <code>label_points</code> is
<code>TRUE</code> the observation numbers corresponding to any values of \(k\)
greater than 0.5 will be displayed in the plot. Any arguments specified in
<code>...</code> will be passed to <code><a href='http://www.rdocumentation.org/packages/graphics/topics/text'>text</a></code> and can be used
to control the appearance of the labels.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>pareto_k_table</code> returns an object of class
  <code>"pareto_k_table"</code>, which is a matrix with columns <code>"Count"</code> and
  <code>"Proportion"</code> and has its own print method.

<code>pareto_k_ids</code> returns an integer vector indicating which
observations have Pareto \(k\) estimates above <code>threshold</code>.</p>
<p>The <code>plot</code> method is called for its side effect and does not
  return anything. If <code>x</code> is the result of a call to <code><a href='loo.html'>loo</a></code>,
  <code>plot(x)</code> produces a plot of the estimates of the Pareto shape
  parameter \(k\). There is no <code>plot</code> method for objects generated by
  a call to <code><a href='waic.html'>waic</a></code>.</p>
    
    <h2 class="hasAnchor" id="pareto-k-diagnostic"><a class="anchor" href="#pareto-k-diagnostic"></a>Pareto k diagnostic</h2>

    <p>The reliability of the PSIS-based estimates can
  be assessed using the estimates for the shape parameter \(k\) of the
  generalized Pareto distribution.</p><ul>
<li><p>If \(k &lt; 1/2\) the variance of the raw importance ratios is finite,
  the central limit theorem holds, and the estimate converges quickly.</p></li>
<li><p>If \(k\) is between 1/2 and 1 the variance of the raw importance
  ratios is infinite but the mean exists, the generalized central limit
  theorem for stable distributions holds, and the convergence of the estimate
  is slower. The variance of the PSIS estimate is finite but may be large.</p></li>
<li><p>If \(k &gt; 1\) the variance and the mean of the raw ratios
  distribution do not exist. The variance of the PSIS estimate is finite but
  may be large.</p></li>
</ul>
    <p>If the estimated tail shape parameter \(k\) exceeds \(0.5\), the user
should be warned, although in practice we have observed good performance for
values of \(k\) up to 0.7. Even if the PSIS estimate has a finite variance,
the user should consider sampling directly from \(p(\theta^s | y_{-i})\)
for the problematic \(i\), use \(k\)-fold cross-validation, or use a more
robust model.</p>
<p>Importance sampling is likely to work less well if the marginal posterior
\(p(\theta^s | y)\) and LOO posterior \(p(\theta^s | y_{-i})\) are much
different, which is more likely to happen with a non-robust model and highly
influential observations. A robust model may reduce the sensitivity to highly
influential observations.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical
  Bayesian model evaluation using leave-one-out cross-validation and WAIC.
  <em>Statistics and Computing</em>. 27(5), 1413--1432.
  doi:10.1007/s11222-016-9696-4.
  (<a href = 'http://link.springer.com/article/10.1007%2Fs11222-016-9696-4'>published
  version</a>, <a href = 'http://arxiv.org/abs/1507.04544'>arXiv preprint</a>).</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2016). Pareto smoothed
  importance sampling. arXiv preprint: <a href = 'http://arxiv.org/abs/1507.02646/'>http://arxiv.org/abs/1507.02646/</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='psislw.html'>psislw</a></code> for the implementation of the PSIS algorithm.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#pareto-k-diagnostic">Pareto k diagnostic</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Aki Vehtari, Andrew Gelman, Jonah Gabry.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
