<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Efficient LOO-CV and WAIC for Bayesian models — loo-package • loo</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Efficient LOO-CV and WAIC for Bayesian models — loo-package" />

<meta property="og:description" content="
  Stan Development Team
This package implements the methods described in Vehtari, Gelman, and Gabry
(2017a, 2017b) and Yao et al. (2018). To get started see the
loo function for efficient approximate leave-one-out
cross-validation (LOO-CV), the psis function for the Pareto
smoothed importance sampling (PSIS) algorithm, or
loo_model_weights for an implementation of Bayesian stacking of
predictive distributions from multiple models." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">loo</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/loo">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Efficient LOO-CV and WAIC for Bayesian models</h1>
    
    </div>

    
    <p><img src='figures/stanlogo.png' width="50px" alt="mc-stan.org" />
  <em>Stan Development Team</em></p>
<p>This package implements the methods described in Vehtari, Gelman, and Gabry
(2017a, 2017b) and Yao et al. (2018). To get started see the
<code><a href='loo.html'>loo</a></code> function for efficient approximate leave-one-out
cross-validation (LOO-CV), the <code><a href='psis.html'>psis</a></code> function for the Pareto
smoothed importance sampling (PSIS) algorithm, or
<code><a href='loo_model_weights.html'>loo_model_weights</a></code> for an implementation of Bayesian stacking of
predictive distributions from multiple models.</p>
    

        
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Leave-one-out cross-validation (LOO-CV) and the widely applicable
  information criterion (WAIC) are methods for estimating pointwise
  out-of-sample prediction accuracy from a fitted Bayesian model using the
  log-likelihood evaluated at the posterior simulations of the parameter
  values. LOO-CV and WAIC have various advantages over simpler estimates of
  predictive error such as AIC and DIC but are less used in practice because
  they involve additional computational steps. This package implements the
  fast and stable computations for approximate LOO-CV laid out in Vehtari,
  Gelman, and Gabry (2017a). From existing posterior simulation draws, we
  compute LOO-CV using Pareto smoothed importance sampling (PSIS; Vehtari,
  Gelman, and Gabry, 2017b), a new procedure for regularizing and diagnosing
  importance weights. As a byproduct of our calculations, we also obtain
  approximate standard errors for estimated predictive errors and for
  comparing of predictive errors between two models.</p>
<p>We recommend PSIS-LOO-CV instead of WAIC, because PSIS provides useful
  diagnostics and effective sample size and Monte Carlo standard error
  estimates.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Vehtari, A., Gelman, A., and Gabry, J. (2017a). Practical
  Bayesian model evaluation using leave-one-out cross-validation and WAIC.
  <em>Statistics and Computing</em>. 27(5), 1413--1432.
  doi:10.1007/s11222-016-9696-4.
  (<a href='http://link.springer.com/article/10.1007%2Fs11222-016-9696-4'>published
  version</a>, <a href='http://arxiv.org/abs/1507.04544'>arXiv preprint</a>).</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017b). Pareto smoothed
  importance sampling. arXiv preprint: <a href='http://arxiv.org/abs/1507.02646/'>http://arxiv.org/abs/1507.02646/</a></p>
<p>Yao, Y., Vehtari, A., Simpson, D., and Gelman, A. (2018) Using
  stacking to average Bayesian predictive distributions. <em>Bayesian
  Analysis</em>, advance publication,  doi:10.1214/17-BA1091.
  (<a href='https://projecteuclid.org/euclid.ba/1516093227'>online</a>).</p>
<p>Epifani, I., MacEachern, S. N., and Peruggia, M. (2008). Case-deletion
importance sampling estimators: Central limit theorems and related results.
<em>Electronic Journal of Statistics</em> <strong>2</strong>, 774-806.</p>
<p>Gelfand, A. E. (1996). Model determination using sampling-based methods. In
<em>Markov Chain Monte Carlo in Practice</em>, ed. W. R. Gilks, S. Richardson,
D. J. Spiegelhalter, 145-162. London: Chapman and Hall.</p>
<p>Gelfand, A. E., Dey, D. K., and Chang, H. (1992). Model determination using
predictive distributions with implementation via sampling-based methods. In
<em>Bayesian Statistics 4</em>, ed. J. M. Bernardo, J. O. Berger, A. P. Dawid,
and A. F. M. Smith, 147-167. Oxford University Press.</p>
<p>Gelman, A., Hwang, J., and Vehtari, A. (2014). Understanding predictive
information criteria for Bayesian models. <em>Statistics and Computing</em>
<strong>24</strong>, 997-1016.</p>
<p>Ionides, E. L. (2008). Truncated importance sampling. <em>Journal of
Computational and Graphical Statistics</em> <strong>17</strong>, 295-311.</p>
<p>Koopman, S. J., Shephard, N., and Creal, D. (2009). Testing the assumptions
behind importance sampling. <em>Journal of Econometrics</em> <strong>149</strong>, 2-11.</p>
<p>Peruggia, M. (1997). On the variability of case-deletion importance sampling
weights in the Bayesian linear model. <em>Journal of the American
Statistical Association</em> <strong>92</strong>, 199-207.</p>
<p>Stan Development Team (2017). The Stan C++ Library, Version 2.17.0.
<a href='http://mc-stan.org'>http://mc-stan.org</a>.</p>
<p>Stan Development Team (2018). RStan: the R interface to Stan, Version 2.17.3.
<a href='http://mc-stan.org'>http://mc-stan.org</a>.</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and
widely application information criterion in singular learning theory.
<em>Journal of Machine Learning Research</em> <strong>11</strong>, 3571-3594.</p>
<p>Zhang, J., and Stephens, M. A. (2009). A new and efficient estimation method
for the generalized Pareto distribution. <em>Technometrics</em> <strong>51</strong>,
316-325.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Aki Vehtari, Andrew Gelman, Jonah Gabry, Yuling Yao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

